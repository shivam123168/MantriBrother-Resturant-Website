<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mantri brother</title>
    <!-- ----------------google font------------ -->
    <!-- --------------------------smartphone----------- -->

    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />

    <!-- --------------location--------- -->
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />

    <!-- --------------------timing----------------- -->
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />

    <!-- -----------------------address------------------- -->
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <!-- -------------------------contact-------------------------- -->
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <!-- --------------------boxicon-------------------- -->
    <!-- -------------------------------socialmedia--------------------------- -->
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>


    <link rel="stylesheet" href="https://unpkg.com/boxicons@latest/css/boxicons.min.css">

    <link rel="stylesheet" href="cart.css">
</head>

<body>


    <!-- -------------navbar-------------- -->
    <div id="contaner" class="navbaar">
        <div class="header">
            <nav>
                <div class="logo">
                    <h2><span>M</span>antri<span>B</span>rother</h2>
                </div>
                <div class="navi">
                    <ul>
                        <li><a href="mainbody.html">Home</a></li>
                        <li><a href="cart.html">Cart</a></li>
                        <li><a href="myorder.html">My order</a></li>
                        <li><a href="manu.html">Menu</a></li>
                        <li><a href="#contactus">Contact</a></li>
                        <li><a href="#aboutus">About us</a></li>
                    </ul>
                </div>
                <div class="toggle_btn">
                    <i class="fa-solid fa-bars"></i>
                </div>
            </nav>


        </div>
        <div class="dropdown_manue">

            <li><a href="mainbody.html">Home</a></li>
            <li><a href="cart.html">Cart</a></li>
            <li><a href="myorder.html">My order</a></li>
            <li><a href="manu.html">Menu</a></li>
            <li><a href="#contactus">Contact</a></li>
            <li><a href="#aboutus">About us</a></li>

        </div>



    </div>

    <div class="cartshow">
        <h2>Your Cart Is Shown Here</h2>
    </div>
    <!-- ----------------------------cart-detail----------------------- -->

    <div class="cart-import product" id="cartContainer">
        <div class="empty">
            <h1>here is me</h1>
        </div>
        <div class="invoice">
            <div class="total_amount">
                <p>The Total Amount Of The Food: <a id="totalAmount"><a></p>
            </div>
            <div class="oreder_bill_btn">
                <button id="generateBill">Generate Bill</button>
                <button id="placeorder">Place Order</button>
            </div>

        </div>
    </div>

    <!-- -----------------------------------YOUR_INVOICE--------------------------------- -->
    <div id="payment"></div>
    <!-- Bill container (hidden by default) -->
    <div class="bill-genrate" id="billContainer" style="display: none;">
        <table class="lower-total  table-with-lines">
            <thead>
                <tr>
                    <th>Item #</th>
                    <th>Item Name</th>
                    <th>Price</th>
                    <th>Quantity</th>
                    <th>Total</th>
                </tr>
            </thead>
            <tbody id="item-details" class="item-detail">
                <!-- Item details will be populated here -->
            </tbody>
            <tfoot id="gst-total-details">
                <!-- GST and Total amount will be populated here -->
            </tfoot>
        </table>
    </div>





    <!-- ---------------------------------------order now-------------------------------- -->


    <!-- --------------------footer----------------------- -->

    <!-- -------------------------contact us------------------- -->


    <!-- <div class="contact" id="contactus">
        <div class="text">
            <h2>Contact us</h2>
        </div>

        <div class="contact-list">
            <div>
                <a href="#"><i class='bx bxl-instagram-alt' id="purple"></i></a>
                <a href="#"><i class='bx bxl-facebook-circle' id="blue"></i></a>
                <a href="#"><i class='bx bxl-whatsapp-square' id="green"></i></a>
                <a href="#"><i class='bx bxl-twitter' id="lblue"></i></a>
            </div>
        </div>

        <div class="contact-list-extra">
            <div>
                <a href="#"><span class="material-symbols-outlined">
                        location_on
                    </span> address</a>
                <a href="#"><span class="material-symbols-outlined">
                        smartphone
                    </span> +91 90xxxxxxxx</a>

            </div>
        </div>
    </div> -->


    <script>

        const toggleBtn = document.querySelector('.toggle_btn');
        const toggleBtnIcon = document.querySelector('.toggle_btn i');
        const dropDownManue = document.querySelector('.dropdown_manue');

        toggleBtn.onclick = function () {
            dropDownManue.classList.toggle('open');
            const isOpen = dropDownManue.classList.contains('open');
            toggleBtnIcon.classList = isOpen ? 'fa-solid fa-xmark' : 'fa-solid fa-bars';
        };

        // Retrieve cart items from localStorage
        const cartItems = JSON.parse(localStorage.getItem('cartItems')) || [];

        // Get the container to display the cart items
        const cartContainer = document.getElementById('cartContainer');
        // Get the payment container
        const payment = document.getElementById('payment');
        // Get the bill container
        const billContainer = document.getElementById('billContainer');
        // Initialize total amount
        let totalAmount = 0;
        const gctRate = 0.15; // Assuming GCT is 15%

        // Function to render the cart items
        function renderCartItems() {
            cartContainer.innerHTML = ''; // Clear existing items before rendering

            // Check if the cart is empty
            if (cartItems.length === 0) {
                const emptyMessage = document.createElement('div');
                emptyMessage.className = 'empty-cart';
                emptyMessage.innerHTML = `<p>Your cart is empty. Add items to get startedðŸ¥ºðŸ¥º!</p>`;
                cartContainer.appendChild(emptyMessage);
                return; // Exit the function since there are no items to render
            }

            // Iterate over the cart items and create HTML elements for each
            cartItems.forEach((item, index) => {
                const cartItemDiv = document.createElement('div');
                cartItemDiv.className = 'cart-item';

                cartItemDiv.innerHTML = `
        <div class="foodcontaner">
            <img src="${item.image}" alt="${item.name}">
            <h2>${item.name}</h2>
            <div class="details">
                <p>Price: Rs.${item.price}</p>
                <div class="quantity">
                    <p>Qty:</p>
                    <input type="number" class="quantity-input" value="${item.quantity || 1}" min="1" data-index="${index}" data-price="${item.price}">
                </div>
                <button class="remove" data-index="${index}">Remove</button>
            </div>
        </div>
    `;

                cartContainer.appendChild(cartItemDiv);
            });

            // Add event listener to the quantity inputs to update the total amount on change
            document.querySelectorAll('.quantity-input').forEach(input => {
                input.addEventListener('change', (event) => {
                    const index = event.target.getAttribute('data-index');
                    const newQuantity = parseInt(event.target.value);
                    updateItemQuantity(index, newQuantity);
                });
            });

            // Add event listener to each remove button
            document.querySelectorAll('.remove').forEach(button => {
                button.addEventListener('click', (event) => {
                    const index = event.target.getAttribute('data-index');
                    removeItem(index);
                });
            });

            // Append the total amount and bill button elements after rendering items
            renderTotalAndButtons();
        }

        // Function to update the item quantity
        function updateItemQuantity(index, quantity) {
            cartItems[index].quantity = quantity; // Update the quantity in the cart array
            localStorage.setItem('cartItems', JSON.stringify(cartItems)); // Save updated cart items to localStorage
            updateTotalAmount(); // Update the total amount display
        }

        // Function to calculate the total amount
        function calculateTotal() {
            let total = 0;
            cartItems.forEach(item => {
                total += (item.quantity || 1) * item.price;
            });
            return total;
        }

        // Update total amount display
        function updateTotalAmount() {
            totalAmount = calculateTotal();
            const gctAmount = totalAmount * gctRate;
            const totalWithGCT = totalAmount + gctAmount;

            const totalAmountElement = document.getElementById('totalAmount');
            if (totalAmountElement) {
                totalAmountElement.innerText = `Rs.${totalWithGCT.toFixed(2)} (GCT included)`;
            }
        }

        // Function to toggle the bill visibility
        function toggleBill() {
            // Check if the bill container is already displayed
            if (billContainer.style.display === 'flex') {
                billContainer.style.display = 'none';
            } else {
                generateBill(); // Generate and display the bill if it's not already shown
                billContainer.style.display = 'flex'; // Make sure the bill container is visible
            }
        }

        // Function to generate and display the bill
        // Function to generate and display the bill
        function generateBill() {
            let itemDetails = "";
            let gstTotalDetails = "";

            cartItems.forEach((item, index) => {
                const price = parseFloat(item.price); // Ensure price is treated as a number
                const quantity = item.quantity || 1;
                const itemTotal = quantity * price;

                itemDetails += `<tr>
            <td>Item ${index + 1}</td>
            <td>${item.name}</td>
            <td>Rs.${price.toFixed(2)}</td>
            <td>${quantity}</td>
            <td>Rs.${itemTotal.toFixed(2)}</td>
        </tr>`;
            });

            const gctAmount = totalAmount * gctRate;
            const totalWithGCT = totalAmount + gctAmount;

            gstTotalDetails += `<tr>
            <td colspan="4" style="text-align: right;">GST:</td>
            <td>Rs.${gctAmount.toFixed(2)}</td>
        </tr>
        <tr>
            <td colspan="4" style="text-align: right;">Total Amount (GST included):</td>
            <td>Rs.${totalWithGCT.toFixed(2)}</td>
        </tr>`;

            document.getElementById('item-details').innerHTML = itemDetails;
            document.getElementById('gst-total-details').innerHTML = gstTotalDetails;
        }


        // Function to remove an item from the cart
        function removeItem(index) {
            cartItems.splice(index, 1); // Remove item from the array
            localStorage.setItem('cartItems', JSON.stringify(cartItems)); // Update localStorage
            renderCartItems(); // Re-render the cart items
            updateTotalAmount(); // Update total amount after removing an item
        }

        // Function to render total amount and buttons
        function renderTotalAndButtons() {
            const totalDiv = document.createElement('div');
            totalDiv.className = 'total-amount';
            totalDiv.innerHTML = `
<div class="invoice">
    <div class="total_amount">
        <p>The Total Amount Of The Food: <a id="totalAmount"></a></p>
    </div> 
    <div class="oreder_bill_btn">
        <button id="generateBill">Generate Bill</button>
        <button id="placeorder">Place Order</button>
    </div>
</div>
`;

            cartContainer.appendChild(totalDiv);

            document.getElementById('generateBill').addEventListener('click', toggleBill);
            document.getElementById('placeorder').addEventListener('click', togglePaymentForm);
        }

        // Function to toggle the payment form visibility
        function togglePaymentForm() {
            const existingForm = document.querySelector('.payment-form');

            if (existingForm) {
                existingForm.remove();
            } else {
                const paymentForm = document.createElement('div');
                paymentForm.className = 'payment-form';
                paymentForm.innerHTML = `
<h3>Payment Information</h3>
<form id="paymentForm">
    <label>
        <input type="radio" name="paymentMethod" value="cash" checked> Cash on Delivery
    </label><br>
    
    <button type="button" onclick="placeOrder()">Confirm Payment</button>
</form>
`;

                payment.appendChild(paymentForm);
            }
        }

        // Function to handle placing the order
        function placeOrder() {
            localStorage.setItem('myOrder', JSON.stringify(cartItems)); // Include quantities in "My Order" page
            window.location.href = 'myorder.html';
        }

        // Initial call to render cart items and update the total amount on page load
        renderCartItems();
        updateTotalAmount();





    </script>






</body>

</html>